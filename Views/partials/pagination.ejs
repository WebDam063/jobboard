<%
function buildPaginationUrl(page) {
    const params = new URLSearchParams();
    params.set('page', page);
    if (typeof search !== 'undefined' && search) params.set('search', search);
    if (typeof location !== 'undefined' && location) params.set('location', location);
    if (typeof contract_type !== 'undefined' && contract_type) params.set('contract_type', contract_type);
    if (typeof working_time !== 'undefined' && working_time) params.set('working_time', working_time);
    if (typeof salary_min !== 'undefined' && salary_min) params.set('salary_min', salary_min);
    if (typeof salary_max !== 'undefined' && salary_max) params.set('salary_max', salary_max);
    return '?' + params.toString();
}
%>

<% if (totalPages > 1) { %>
    <div class="pagination">
        <% if (currentPage > 1) { %>
            <a href="<%= buildPaginationUrl(currentPage - 1) %>" class="pagination-btn">
                <i data-lucide="chevron-left" style="width: 16px; height: 16px;"></i>
                Précédent
            </a>
        <% } %>
        
        <div class="pagination-numbers">
            <% for (let i = 1; i <= totalPages; i++) { %>
                <% if (i === currentPage) { %>
                    <span class="pagination-number active"><%= i %></span>
                <% } else if (Math.abs(i - currentPage) <= 2 || i === 1 || i === totalPages) { %>
                    <a href="<%= buildPaginationUrl(i) %>" class="pagination-number"><%= i %></a>
                <% } else if (Math.abs(i - currentPage) === 3) { %>
                    <span class="pagination-ellipsis">...</span>
                <% } %>
            <% } %>
        </div>
        
        <% if (currentPage < totalPages) { %>
            <a href="<%= buildPaginationUrl(currentPage + 1) %>" class="pagination-btn">
                Suivant
                <i data-lucide="chevron-right" style="width: 16px; height: 16px;"></i>
            </a>
        <% } %>
    </div>
<% } %>

